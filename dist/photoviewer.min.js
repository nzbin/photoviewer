/*!
 *     ____  __  ______  __________ _    _____________       ____________ 
 *    / __ \/ / / / __ \/_  __/ __ \ |  / /  _/ ____/ |     / / ____/ __ \
 *   / /_/ / /_/ / / / / / / / / / / | / // // __/  | | /| / / __/ / /_/ /
 *  / ____/ __  / /_/ / / / / /_/ /| |/ // // /___  | |/ |/ / /___/ _, _/
 * /_/   /_/ /_/\____/ /_/  \____/ |___/___/_____/  |__/|__/_____/_/ |_|                                                            
 *
 * photoviewer - v3.4.0
 * A JS plugin to view images just like in Windows
 * https://nzbin.github.io/photoviewer/
 *
 * Copyright (c) 2018 nzbin
 * Released under MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.photoviewer=e()}(this,function(){"use strict";var d=function(t,e){return new d.fn.init(t,e)},c=window.document,o=[],n=o.concat,s=o.filter,l=o.slice,e={},i={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},a=/^\s*<(\w+|!)[^>]*>/,r=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,h=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,u=/^(?:body|html)$/i,f=["val","css","html","text","data","width","height","offset"],t=c.createElement("table"),p=c.createElement("tr"),g={tr:c.createElement("tbody"),tbody:t,thead:t,tfoot:t,td:p,th:p,"*":c.createElement("div")},m=/^[\w-]*$/,v={},w=v.toString,x=c.createElement("div"),b=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},y=c.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e=e&&e.parentNode;)if(e===t)return!0;return!1};function z(t){return null==t?String(t):v[w.call(t)]||"object"}function $(t){return"function"==z(t)}function M(t){return null!=t&&t==t.window}function T(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function C(t){return"object"==z(t)}function L(t){return C(t)&&!M(t)&&Object.getPrototypeOf(t)==Object.prototype}function H(t){var e=!!t&&"length"in t&&t.length,i=z(t);return"function"!=i&&!M(t)&&("array"==i||0===e||"number"==typeof e&&0<e&&e-1 in t)}function D(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function V(t,e){return"number"!=typeof e||i[D(t)]?e:e+"px"}function I(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function E(t){return t in e?e[t]:e[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function R(t){return t instanceof d}function S(t,e,i,o){return $(e)?e.call(t,i,o):e}function A(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function k(t,e){var i=t.className||"",o=i&&void 0!==i.baseVal;if(void 0===e)return o?i.baseVal:i;o?i.baseVal=e:t.className=e}function O(e,i){var t=e.replace(/./,function(t){return t[0].toUpperCase()}),o=this[0];return void 0===i?M(o)?o["inner"+t]:T(o)?o.documentElement["scroll"+t]:function(t,e){return"border-box"===t.css("box-sizing")?"width"===e?parseFloat(t.css(e))-parseFloat(t.css("padding-left"))-parseFloat(t.css("padding-right"))-parseFloat(t.css("border-left-width"))-parseFloat(t.css("border-right-width")):parseFloat(t.css(e))-parseFloat(t.css("padding-top"))-parseFloat(t.css("padding-bottom"))-parseFloat(t.css("border-top-width"))-parseFloat(t.css("border-bottom-width")):parseFloat(t.css(e))}(this,e):this.each(function(t){(o=d(this)).css(e,S(this,i,t,o[e]()))})}d.fn=d.prototype={constuctor:d,length:0,forEach:o.forEach,reduce:o.reduce,push:o.push,sort:o.sort,splice:o.splice,indexOf:o.indexOf,init:function(t,e){var i;if(!t)return this;if("string"==typeof t)if("<"==(t=t.trim())[0]&&a.test(t))i=d.fragment(t,RegExp.$1,e),t=null;else{if(void 0!==e)return d(e).find(t);i=d.qsa(c,t)}else{if($(t))return d(c).ready(t);if(R(t))return t;if(b(t))i=function(t){return s.call(t,function(t){return null!=t})}(t);else if(C(t))i=[t],t=null;else{if(void 0!==e)return d(e).find(t);i=d.qsa(c,t)}}return d.makeArray(i,t,this)},concat:function(){var t,e,i=[];for(t=0;t<arguments.length;t++)e=arguments[t],i[t]=R(e)?e.toArray():e;return n.apply(R(this)?this.toArray():this,i)},pluck:function(e){return d.map(this,function(t){return t[e]})},toArray:function(){return this.get()},get:function(t){return void 0===t?l.call(this):this[0<=t?t:t+this.length]},size:function(){return this.length},each:function(i){return o.every.call(this,function(t,e){return!1!==i.call(t,e,t)}),this},map:function(i){return d(d.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return d(l.apply(this,arguments))},first:function(){var t=this[0];return t&&!C(t)?t:d(t)},last:function(){var t=this[this.length-1];return t&&!C(t)?t:d(t)},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)}},d.extend=d.fn.extend=function(){var t,e,i,o,n,s,a=arguments[0]||{},r=1,h=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[r]||{},r++),"object"==typeof a||$(a)||(a={}),r===h&&(a=this,r--);r<h;r++)if(null!=(t=arguments[r]))for(e in t)i=a[e],a!==(o=t[e])&&(l&&o&&(L(o)||(n=b(o)))?(s=n?(n=!1,i&&b(i)?i:[]):i&&L(i)?i:{},a[e]=d.extend(l,s,o)):void 0!==o&&(a[e]=o));return a},d.extend({makeArray:function(t,e,i){var o,n=t?t.length:0;for(o=0;o<n;o++)i[o]=t[o];return i.length=n,i.selector=e||"",i},qsa:function(t,e){var i,o="#"==e[0],n=!o&&"."==e[0],s=o||n?e.slice(1):e,a=m.test(s);return t.getElementById&&a&&o?(i=t.getElementById(s))?[i]:[]:1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType?[]:l.call(a&&!o&&t.getElementsByClassName?n?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},fragment:function(t,e,i){var o,n,s;return r.test(t)&&(o=d(c.createElement(RegExp.$1))),o||(t.replace&&(t=t.replace(h,"<$1></$2>")),void 0===e&&(e=a.test(t)&&RegExp.$1),e in g||(e="*"),(s=g[e]).innerHTML=""+t,o=d.each(l.call(s.childNodes),function(){s.removeChild(this)})),L(i)&&(n=d(o),d.each(i,function(t,e){-1<f.indexOf(t)?n[t](e):n.attr(t,e)})),o},matches:function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var o,n=t.parentNode,s=!n;return s&&(n=x).appendChild(t),o=~d.qsa(n,e).indexOf(t),s&&x.removeChild(t),o},each:function(t,e){var i,o;if(H(t)){for(i=0;i<t.length;i++)if(!1===e.call(t[i],i,t[i]))return t}else for(o in t)if(!1===e.call(t[o],o,t[o]))return t;return t},map:function(t,e){var i,o,n,s=[];if(H(t))for(o=0;o<t.length;o++)null!=(i=e(t[o],o))&&s.push(i);else for(n in t)null!=(i=e(t[n],n))&&s.push(i);return function(t){return 0<t.length?d.fn.concat.apply([],t):t}(s)}}),d.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){v["[object "+e+"]"]=e.toLowerCase()}),d.fn.init.prototype=d.fn;var F=function(t,e){e(t);for(var i=0,o=t.childNodes.length;i<o;i++)F(t.childNodes[i],e)};var P=1;function j(t){return t._zid||(t._zid=P++)}function N(t){return"string"==typeof t}var B=function(){return!0},_=function(){return!1},Y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function W(o,n){if(n||!o.isDefaultPrevented){n=n||o,d.each(Y,function(t,e){var i=n[t];o[t]=function(){return this[e]=B,i&&i.apply(n,arguments)},o[e]=_});try{o.timeStamp||(o.timeStamp=Date.now())}catch(t){}(void 0!==n.defaultPrevented?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(o.isDefaultPrevented=B)}return o}var X={},q="onfocusin"in window,Z={focus:"focusin",blur:"focusout"},K={mouseenter:"mouseover",mouseleave:"mouseout"},U=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/;function G(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function J(t,e,i,o){if((e=G(e)).ns)var n=function(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}(e.ns);return(X[j(t)]||[]).filter(function(t){return t&&(!e.e||t.e==e.e)&&(!e.ns||n.test(t.ns))&&(!i||j(t.fn)===j(i))&&(!o||t.sel==o)})}function Q(t,e){return t.del&&!q&&t.e in Z||!!e}function tt(t){return K[t]||q&&Z[t]||t}function et(e,t,i,o,n){var s=j(e);(t||"").split(/\s/).forEach(function(t){J(e,t,i,o).forEach(function(t){delete X[s][t.i],"removeEventListener"in e&&e.removeEventListener(tt(t.e),t.proxy,Q(t,n))})})}var it,ot="",nt=c.createElement("div"),st=nt.style.transitionProperty;function at(t){return it?it+t:t.toLowerCase()}void 0===nt.style.transform&&d.each({Webkit:"webkit",Moz:"",O:"o"},function(t,e){if(void 0!==nt.style[t+"TransitionProperty"])return ot="-"+t.toLowerCase()+"-",it=e,!1}),nt=null,d.fx={off:void 0===it&&void 0===st,speeds:{_default:400,fast:200,slow:600},cssPrefix:ot,transitionEnd:at("TransitionEnd"),animationEnd:at("AnimationEnd")};var rt,ht,lt,ct,ut,ft,dt,pt,gt,mt=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,vt={};rt=ot+"transform",vt[ht=ot+"transition-property"]=vt[lt=ot+"transition-duration"]=vt[ut=ot+"transition-delay"]=vt[ct=ot+"transition-timing-function"]=vt[ft=ot+"animation-name"]=vt[dt=ot+"animation-duration"]=vt[gt=ot+"animation-delay"]=vt[pt=ot+"animation-timing-function"]="";function wt(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=defaultDisplay(this.nodeName))})}function xt(){return this.css("display","none")}function bt(t,e,i,o,n){"function"!=typeof e||n||(n=e,e=void 0);var s={opacity:i};return o&&(s.scale=o,t.css(d.fx.cssPrefix+"transform-origin","0 0")),t.animate(s,e,null,n)}var yt=d,zt={isArray:b,noop:function(){}},$t={find:function(t){var i=this;return t?"object"==typeof t?d(t).filter(function(){var e=this;return o.some.call(i,function(t){return y(t,e)})}):1==this.length?d(d.qsa(this[0],t)):this.map(function(){return d.qsa(this,t)}):d()},closest:function(i,o){var n=[],s="object"==typeof i&&d(i);return this.each(function(t,e){for(;e&&!(s?0<=s.indexOf(e):d.matches(e,i));)e=e!==o&&!T(e)&&e.parentNode;e&&n.indexOf(e)<0&&n.push(e)}),d(n)},css:function(t,e){if(arguments.length<2){var i=this[0];if("string"==typeof t){if(!i)return;return i.style[I(t)]||getComputedStyle(i,"").getPropertyValue(t)}if(b(t)){if(!i)return;var o={},n=getComputedStyle(i,"");return d.each(t,function(t,e){o[e]=i.style[I(e)]||n.getPropertyValue(e)}),o}}var s="";if("string"==z(t))e||0===e?s=D(t)+":"+V(t,e):this.each(function(){this.style.removeProperty(D(t))});else for(var a in t)t[a]||0===t[a]?s+=D(a)+":"+V(a,t[a])+";":this.each(function(){this.style.removeProperty(D(a))});return this.each(function(){this.style.cssText+=";"+s})},addClass:function(i){var o=[];return i?this.each(function(t){if("className"in this){o=[];var e=k(this);S(this,i,t,e).split(/\s+/g).forEach(function(t){d(this).hasClass(t)||o.push(t)},this),o.length&&k(this,e+(e?" ":"")+o.join(" "))}}):this},hasClass:function(t){return!!t&&o.some.call(this,function(t){return this.test(k(t))},E(t))},removeClass:function(e){var i=[];return this.each(function(t){if("className"in this){if(void 0===e)return k(this,"");i=k(this),S(this,e,t,i).split(/\s+/g).forEach(function(t){i=i.replace(E(t)," ")}),k(this,i.trim())}})},attr:function(i,o){var t;return"string"!=typeof i||1 in arguments?this.each(function(t){if(1===this.nodeType)if(C(i))for(var e in i)A(this,e,i[e]);else A(this,i,S(this,o,t,this.getAttribute(i)))}):0 in this&&1==this[0].nodeType&&null!=(t=this[0].getAttribute(i))?t:void 0},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){A(this,t)},this)})},append:function(){return function(t,e,o,n){var i,s,a=d.map(e,function(t){var e=[];return"array"==(i=z(t))?(t.forEach(function(t){return void 0!==t.nodeType?e.push(t):R(t)?e=e.concat(t.get()):void(e=e.concat(d.fragment(t)))}),e):"object"==i||null==t?t:d.fragment(t)}),r=1<t.length;return a.length<1?t:t.each(function(t,e){s=n?e:e.parentNode;var i=y(c.documentElement,s);a.forEach(function(t){if(r)t=t.cloneNode(!0);else if(!s)return d(t).remove();o.call(e,t),i&&F(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var e=t.ownerDocument?t.ownerDocument.defaultView:window;e.eval.call(e,t.innerHTML)}})})})}(this,arguments,function(t){this.insertBefore(t,null)},!0)},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},empty:function(){return this.each(function(){this.innerHTML=""})},html:function(i){return 0 in arguments?this.each(function(t){var e=this.innerHTML;d(this).empty().append(S(this,i,t,e))}):0 in this?this[0].innerHTML:null},width:function(t){return O.call(this,"width",t)},height:function(t){return O.call(this,"height",t)},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return void 0===t?e?this[0].scrollTop:M(this[0])?this[0].pageYOffset:this[0].defaultView.pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return void 0===t?e?this[0].scrollLeft:M(this[0])?this[0].pageXOffset:this[0].defaultView.pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},offset:function(s){if(s)return this.each(function(t){var e=d(this),i=S(this,s,t,e.offset()),o=e.offsetParent().offset(),n={top:i.top-o.top,left:i.left-o.left};"static"==e.css("position")&&(n.position="relative"),e.css(n)});if(!this.length)return null;if(c.documentElement!==this[0]&&!y(c.documentElement,this[0]))return{top:0,left:0};var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||c.body;t&&!u.test(t.nodeName)&&"static"==d(t).css("position");)t=t.offsetParent;return t})},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),o=u.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(d(t).css("margin-top"))||0,i.left-=parseFloat(d(t).css("margin-left"))||0,o.top+=parseFloat(d(e[0]).css("border-top-width"))||0,o.left+=parseFloat(d(e[0]).css("border-left-width"))||0,{top:i.top-o.top,left:i.left-o.left}}},on:function(e,n,i,s,a){var r,h,o=this;return e&&!N(e)?(d.each(e,function(t,e){o.on(t,n,i,e,a)}),o):(N(n)||$(s)||!1===s||(s=i,i=n,n=void 0),void 0!==s&&!1!==i||(s=i,i=void 0),!1===s&&(s=_),o.each(function(t,o){a&&(r=function(t){return et(o,t.type,s),s.apply(this,arguments)}),n&&(h=function(t){var e,i=d(t.target).closest(n,o).get(0);if(i&&i!==o)return e=d.extend(function(t){var e,i={originalEvent:t};for(e in t)U.test(e)||void 0===t[e]||(i[e]=t[e]);return W(i,t)}(t),{currentTarget:i,liveFired:o}),(r||s).apply(i,[e].concat(l.call(arguments,1)))}),function(n,t,e,s,a,r,h){var i=j(n),l=X[i]||(X[i]=[]);t.split(/\s/).forEach(function(t){if("ready"==t)return d(c).ready(e);var i=G(t);i.fn=e,i.sel=a,i.e in K&&(e=function(t){var e=t.relatedTarget;if(!e||e!==this&&!y(this,e))return i.fn.apply(this,arguments)});var o=(i.del=r)||e;i.proxy=function(t){if(!(t=W(t)).isImmediatePropagationStopped()){t.data=s;var e=o.apply(n,null==t._args?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},i.i=l.length,l.push(i),"addEventListener"in n&&n.addEventListener(tt(i.e),i.proxy,Q(i,h))})}(o,e,s,i,n,h||r)}))},off:function(t,i,e){var o=this;return t&&!N(t)?(d.each(t,function(t,e){o.off(t,i,e)}),o):(N(i)||$(e)||!1===e||(e=i,i=void 0),!1===e&&(e=_),o.each(function(){et(this,t,e,i)}))},show:function(t,e){return wt.call(this),void 0===t?t=0:this.css("opacity",0),bt(this,t,1,"1,1",e)},hide:function(t,e){return void 0===t?xt.call(this):function(t,e,i,o){return bt(t,e,0,i,function(){xt.call(d(this)),o&&o.call(this)})}(this,t,"0,0",e)},anim:function(t,e,i,o,n){var s,a,r,h={},l="",c=this,u=d.fx.transitionEnd,f=!1;if(void 0===e&&(e=d.fx.speeds._default/1e3),void 0===n&&(n=0),d.fx.off&&(e=0),"string"==typeof t)h[ft]=t,h[dt]=e+"s",h[gt]=n+"s",h[pt]=i||"linear",u=d.fx.animationEnd;else{for(s in a=[],t)mt.test(s)?l+=s+"("+t[s]+") ":(h[s]=t[s],a.push(s.replace(/([A-Z])/g,"-$1").toLowerCase()));l&&(h[rt]=l,a.push(rt)),0<e&&"object"==typeof t&&(h[ht]=a.join(", "),h[lt]=e+"s",h[ut]=n+"s",h[ct]=i||"linear")}return r=function(t){if(void 0!==t){if(t.target!==t.currentTarget)return;d(t.target).off(u,r)}else d(this).off(u,r);f=!0,d(this).css(vt),o&&o.call(this)},0<e&&(this.on(u,r),setTimeout(function(){f||r.call(c)},1e3*(e+n)+25)),this.size()&&this.get(0).clientLeft,this.css(h),e<=0&&setTimeout(function(){c.each(function(){r.call(this)})},0),this},animate:function(t,e,i,o,n){return $(e)&&(o=e,e=i=void 0),$(i)&&(o=i,i=void 0),L(e)&&(i=e.easing,o=e.complete,n=e.delay,e=e.duration),e=e&&("number"==typeof e?e:d.fx.speeds[e]||d.fx.speeds._default)/1e3,n=n&&parseFloat(n)/1e3,this.anim(t,e,i,o,n)},fadeTo:function(t,e,i){return bt(this,t,e,null,i)},fadeIn:function(t,e){var i=this.css("opacity");return 0<i?this.css("opacity",0):i=1,wt.call(this).fadeTo(t,i,e)}};yt.extend(zt),yt.fn.extend($t);var Mt={draggable:!0,resizable:!0,movable:!0,keyboard:!0,title:!0,modalWidth:320,modalHeight:320,fixedContent:!0,fixedModalSize:!1,initMaximized:!1,gapThreshold:.02,ratioThreshold:.1,minRatio:.05,maxRatio:16,headToolbar:["maximize","close"],footToolbar:["zoomIn","zoomOut","prev","fullscreen","next","actualSize","rotateRight"],icons:{minimize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M20,14H4V10H20"></path>\n      </svg>',maximize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M4,4H20V20H4V4M6,8V18H18V8H6Z"></path>\n      </svg>',close:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12\n        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z"></path>\n      </svg>',zoomIn:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43\n        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5\n        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5\n        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z"></path>\n      </svg>',zoomOut:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5\n        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16\n        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14\n        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z"></path>\n      </svg>',prev:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"></path>\n      </svg>',next:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z"></path>\n      </svg>',fullscreen:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3\n        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z"></path>\n      </svg>',actualSize:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09\n        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19\n        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91\n        L13.09,9.5Z"></path>\n      </svg>',rotateLeft:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12\n        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07\n        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32\n        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13\n        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z"></path>\n      </svg>',rotateRight:'<svg viewBox="0 0 24 24" class="svg-inline-icon">\n        <path fill="currentColor" d="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91\n        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31\n        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11\n        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12\n        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10\n        L15.55,5.55Z"></path>\n      </svg>'},i18n:{minimize:"minimize",maximize:"maximize",close:"close",zoomIn:"zoom-in(+)",zoomOut:"zoom-out(-)",prev:"prev(←)",next:"next(→)",fullscreen:"fullscreen",actualSize:"actual-size(Ctrl+Alt+0)",rotateLeft:"rotate-left(Ctrl+,)",rotateRight:"rotate-right(Ctrl+.)"},multiInstances:!0,initAnimation:!0,fixedModalPos:!1,zIndex:1090,dragHandle:!1,callbacks:{beforeOpen:yt.noop,opened:yt.noop,beforeClose:yt.noop,closed:yt.noop,beforeChange:yt.noop,changed:yt.noop},index:0,progressiveLoading:!0,appendTo:"body"},Tt=window.document;function Ct(t,e,i,o){var n=o?t.h:t.w,s=o?t.w:t.h;(s>e.h||n>e.w)&&i.addClass("is-grab"),s<=e.h&&n<=e.w&&i.removeClass("is-grab")}function Lt(){return!!("ontouchstart"in window||window.DocumentTouch&&Tt instanceof window.DocumentTouch)}var Ht=yt(window),Dt=yt(Tt),Vt="click",It="keydown",Et="wheel mousewheel DOMMouseScroll",Rt=Lt()?"touchstart":"mousedown",St=Lt()?"touchmove":"mousemove",At=Lt()?"touchend":"mouseup",kt="photoviewer",Ot="."+kt,Ft="."+kt,Pt={isMoving:!1,isResizing:!1,zIndex:0},jt={draggable:function(s,t,e){var a=this,r=!1,h=0,l=0,c=0,u=0,i=function(t){if((t=t||window.event).preventDefault(),r&&!Pt.isMoving&&!Pt.isResizing&&!a.isMaximized){var e="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,i="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,o=e-h,n=i-l;yt(s).css({left:o+c+"px",top:n+u+"px"})}},o=function t(){Dt.off(St+Ft,i).off(At+Ft,t),r=!1};yt(t).on(Rt+Ft,function(t){if(t=t||window.event,yt(t.target).closest(e).length)return!0;a.options.multiInstances&&s.css("z-index",++Pt.zIndex),r=!0,h="touchstart"===t.type?t.targetTouches[0].pageX:t.clientX,l="touchstart"===t.type?t.targetTouches[0].pageY:t.clientY,c=yt(s).offset().left,u=yt(s).offset().top,Dt.on(St+Ft,i).on(At+Ft,o)})}},Nt="html, body, ."+kt+"-modal, ."+kt+"-stage, ."+kt+"-button, ."+kt+"-resizable-handle",Bt={movable:function(s,r){var h=this,l=!1,c=0,u=0,f=0,d=0,p=0,g=0,m=0,a=function(t){if((t=t||window.event).preventDefault(),l){var e="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,i="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,o=e-c,n=i-u,s=o+f,a=n+d;0<g?m<n+d?a=m:n+d<-g+m&&(a=-g+m):a=d,0<p?-m<o+f?s=-m:o+f<-p-m&&(s=-p-m):s=f,yt(r).css({left:s+"px",top:a+"px"}),yt.extend(h.imageData,{left:s,top:a})}},v=function t(){Dt.off(St+Ft,a).off(At+Ft,t),l=!1,Pt.isMoving=!1,yt(Nt).removeClass("is-grabbing")};yt(s).on(Rt+Ft,function(t){(t=t||window.event).preventDefault();var e=yt(r).width(),i=yt(r).height(),o=yt(s).width(),n=yt(s).height();c="touchstart"===t.type?t.targetTouches[0].pageX:t.clientX,u="touchstart"===t.type?t.targetTouches[0].pageY:t.clientY,m=h.isRotated?(e-i)/2:0,p=h.isRotated?i-o:e-o,g=h.isRotated?e-n:i-n,l=0<p||0<g,Pt.isMoving=0<p||0<g,f=yt(r).position().left-m,d=yt(r).position().top+m,s.hasClass("is-grab")&&yt(Nt).addClass("is-grabbing"),Dt.on(St+Ft,a).on(At+Ft,v)})}},_t="html, body, ."+kt+"-modal, ."+kt+"-stage, ."+kt+"-button",Yt={resizable:function(r,i,u,f,d){var h=this,t=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-e"></div>'),e=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-w"></div>'),o=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-s"></div>'),n=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-n"></div>'),s=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-se"></div>'),a=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-sw"></div>'),l=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-ne"></div>'),c=yt('<div class="'+kt+"-resizable-handle "+kt+'-resizable-handle-nw"></div>'),p={e:t,s:o,se:s,n:n,w:e,nw:c,ne:l,sw:a};yt(r).append(t,e,o,n,s,a,l,c);var g=!1,m=0,v=0,w={w:0,h:0,l:0,t:0},x={w:0,h:0,l:0,t:0},b={w:0,h:0,l:0,t:0},y=0,z=0,$=0,M="",T=function(t){if((t=t||window.event).preventDefault(),g&&!h.isMaximized){var e="touchmove"===t.type?t.targetTouches[0].pageX:t.clientX,i="touchmove"===t.type?t.targetTouches[0].pageY:t.clientY,o=e-m,n=i-v,s=function(t,e,i){var o=-e+w.w>f?e+w.l:w.l+w.w-f,n=-i+w.h>d?i+w.t:w.t+w.h-d;return{e:{width:Math.max(e+w.w,f)+"px"},s:{height:Math.max(i+w.h,d)+"px"},se:{width:Math.max(e+w.w,f)+"px",height:Math.max(i+w.h,d)+"px"},w:{width:Math.max(-e+w.w,f)+"px",left:o+"px"},n:{height:Math.max(-i+w.h,d)+"px",top:n+"px"},nw:{width:Math.max(-e+w.w,f)+"px",height:Math.max(-i+w.h,d)+"px",top:n+"px",left:o+"px"},ne:{width:Math.max(e+w.w,f)+"px",height:Math.max(-i+w.h,d)+"px",top:n+"px"},sw:{width:Math.max(-e+w.w,f)+"px",height:Math.max(i+w.h,d)+"px",left:o+"px"}}[t]}(M,o,n);yt(r).css(s);var a=function(t,e,i){var o=e+w.w>f?x.w-z+e-y:f-(w.w-x.w)-z-y,n=i+w.h>d?x.h-$+i+y:d-(w.h-x.h)-$+y,s=-e+w.w>f?x.w-z-e-y:f-(w.w-x.w)-z-y,a=-i+w.h>d?x.h-$-i+y:d-(w.h-x.h)-$+y,r=(0<o?yt(u).position().left:yt(u).position().left<0?yt(u).position().left:0)-y,h=(0<n?yt(u).position().top:yt(u).position().top<0?yt(u).position().top:0)+y,l=(0<s?yt(u).position().left:yt(u).position().left<0?yt(u).position().left:0)-y,c=(0<a?yt(u).position().top:yt(u).position().top<0?yt(u).position().top:0)+y;return{e:{left:-y<=o?(o-y)/2+"px":o<r?r+"px":o+"px"},s:{top:y<=n?(n+y)/2+"px":n<h?h+"px":n+"px"},se:{top:y<=n?(n+y)/2+"px":n<h?h+"px":n+"px",left:-y<=o?(o-y)/2+"px":o<r?r+"px":o+"px"},w:{left:-y<=s?(s-y)/2+"px":s<l?l+"px":s+"px"},n:{top:y<=a?(a+y)/2+"px":a<c?c+"px":a+"px"},nw:{top:y<=a?(a+y)/2+"px":a<c?c+"px":a+"px",left:-y<=s?(s-y)/2+"px":s<l?l+"px":s+"px"},ne:{top:y<=a?(a+y)/2+"px":a<c?c+"px":a+"px",left:-y<=o?(o-y)/2+"px":o<r?r+"px":o+"px"},sw:{top:y<=n?(n+y)/2+"px":n<h?h+"px":n+"px",left:-y<=s?(s-y)/2+"px":s<l?l+"px":s+"px"}}[t]}(M,o,n);yt(u).css(a),h.isDoResize=!0}},C=function t(){Dt.off(St+Ft,T).off(At+Ft,t),Pt.isResizing&&Ct({w:z,h:$},{w:yt(i).width(),h:yt(i).height()},i),g=!1,Pt.isResizing=!1,yt(_t).css("cursor","");var e=h.getImageScaleToStage(yt(i).width(),yt(i).height());yt.extend(h.imageData,{initWidth:h.img.width*e,initHeight:h.img.height*e,initLeft:(yt(i).width()-h.img.width*e)/2,initTop:(yt(i).height()-h.img.height*e)/2})};yt.each(p,function(e,t){t.on(Rt+Ft,function(t){!function(t,e){(e=e||window.event).preventDefault(),g=!0,Pt.isResizing=!0,m="touchstart"===e.type?e.targetTouches[0].pageX:e.clientX,v="touchstart"===e.type?e.targetTouches[0].pageY:e.clientY,w={w:yt(r).width(),h:yt(r).height(),l:yt(r).offset().left,t:yt(r).offset().top},x={w:yt(i).width(),h:yt(i).height(),l:yt(i).offset().left,t:yt(i).offset().top},b={w:yt(u).width(),h:yt(u).height(),l:yt(u).position().left,t:yt(u).position().top},y=h.isRotated?(b.w-b.h)/2:0,z=h.isRotated?b.h:b.w,$=h.isRotated?b.w:b.h,M=t,yt(_t).css("cursor",t+"-resize"),Dt.on(St+Ft,T).on(At+Ft,C)}(e,t)})})}},Wt=function(){function t(t,e,i){this.options=yt.extend(!0,{},Mt,e),e&&yt.isArray(e.footToolbar)&&(this.options.footToolbar=e.footToolbar),e&&yt.isArray(e.headToolbar)&&(this.options.headToolbar=e.headToolbar),this.$el=yt(i),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0,this.isDoResize=!1,this.imageData={},this.modalData={width:null,height:null,left:null,top:null},this.init(t,this.options)}var e=t.prototype;return e.init=function(t,e){this.groupData=t,this.groupIndex=e.index,Pt.zIndex=0===Pt.zIndex?e.zIndex:Pt.zIndex;var i=t[this.groupIndex].src;this.open(),this.loadImg(i),e.draggable&&this.draggable(this.$photoviewer,this.dragHandle,Ot+"-button"),e.movable&&this.movable(this.$stage,this.$image),e.resizable&&this.resizable(this.$photoviewer,this.$stage,this.$image,e.modalWidth,e.modalHeight)},e._createBtns=function(t,i){var o="";return yt.each(t,function(t,e){o+=i[e]}),o},e._createTitle=function(){return this.options.title?'<div class="'+kt+'-title"></div>':""},e.render=function(){var t={minimize:'<button class="'+kt+"-button "+kt+'-button-minimize" title="'+this.options.i18n.minimize+'">\n          '+this.options.icons.minimize+"\n        </button>",maximize:'<button class="'+kt+"-button "+kt+'-button-maximize" title="'+this.options.i18n.maximize+'">\n          '+this.options.icons.maximize+"\n        </button>",close:'<button class="'+kt+"-button "+kt+'-button-close" title="'+this.options.i18n.close+'">\n          '+this.options.icons.close+"\n        </button>",zoomIn:'<button class="'+kt+"-button "+kt+'-button-zoom-in" title="'+this.options.i18n.zoomIn+'">\n          '+this.options.icons.zoomIn+"\n        </button>",zoomOut:'<button class="'+kt+"-button "+kt+'-button-zoom-out" title="'+this.options.i18n.zoomOut+'">\n          '+this.options.icons.zoomOut+"\n        </button>",prev:'<button class="'+kt+"-button "+kt+'-button-prev" title="'+this.options.i18n.prev+'">\n          '+this.options.icons.prev+"\n        </button>",next:'<button class="'+kt+"-button "+kt+'-button-next" title="'+this.options.i18n.next+'">\n          '+this.options.icons.next+"\n        </button>",fullscreen:'<button class="'+kt+"-button "+kt+'-button-fullscreen" title="'+this.options.i18n.fullscreen+'">\n          '+this.options.icons.fullscreen+"\n        </button>",actualSize:'<button class="'+kt+"-button "+kt+'-button-actual-size" title="'+this.options.i18n.actualSize+'">\n          '+this.options.icons.actualSize+"\n        </button>",rotateLeft:'<button class="'+kt+"-button "+kt+'-button-rotate-left" title="'+this.options.i18n.rotateLeft+'">\n          '+this.options.icons.rotateLeft+"\n        </button>",rotateRight:'<button class="'+kt+"-button "+kt+'-button-rotate-right" title="'+this.options.i18n.rotateRight+'">\n          '+this.options.icons.rotateRight+"\n        </button>"};return'<div class="'+kt+'-modal">\n        <div class="'+kt+'-inner">\n          <div class="'+kt+'-header">\n            <div class="'+kt+"-toolbar "+kt+'-toolbar-head">\n              '+this._createBtns(this.options.headToolbar,t)+"\n            </div>\n            "+this._createTitle()+'\n          </div>\n          <div class="'+kt+'-stage">\n            <img class="'+kt+'-image" src="" alt="" />\n          </div>\n          <div class="'+kt+'-footer">\n            <div class="'+kt+"-toolbar "+kt+'-toolbar-foot">\n              '+this._createBtns(this.options.footToolbar,t)+"\n            </div>\n          </div>\n        </div>\n      </div>"},e.build=function(){var t=this.render(),e=yt(t);this.$photoviewer=e,this.$header=e.find(Ot+"-header"),this.$headToolbar=e.find(Ot+"-toolbar-head"),this.$footer=e.find(Ot+"-footer"),this.$footToolbar=e.find(Ot+"-toolbar-foot"),this.$stage=e.find(Ot+"-stage"),this.$title=e.find(Ot+"-title"),this.$image=e.find(Ot+"-image"),this.$close=e.find(Ot+"-button-close"),this.$maximize=e.find(Ot+"-button-maximize"),this.$minimize=e.find(Ot+"-button-minimize"),this.$zoomIn=e.find(Ot+"-button-zoom-in"),this.$zoomOut=e.find(Ot+"-button-zoom-out"),this.$actualSize=e.find(Ot+"-button-actual-size"),this.$fullscreen=e.find(Ot+"-button-fullscreen"),this.$rotateLeft=e.find(Ot+"-button-rotate-left"),this.$rotateRight=e.find(Ot+"-button-rotate-right"),this.$prev=e.find(Ot+"-button-prev"),this.$next=e.find(Ot+"-button-next"),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.$photoviewer.css("z-index",Pt.zIndex),this.options.dragHandle&&this.options.dragHandle!==Ot+"-modal"?this.dragHandle=this.$photoviewer.find(this.options.dragHandle):this.dragHandle=this.$photoviewer},e.open=function(){if(this.options.multiInstances||yt(Ot+"-modal").eq(0).remove(),!yt(Ot+"-modal").length&&this.options.fixedContent&&(yt("html").css({overflow:"hidden"}),Tt.body.scrollHeight>(window.innerHeight||Tt.documentElement.clientHeight))){var t=function(){var t=Tt.createElement("div");t.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",Tt.body.appendChild(t);var e=t.offsetWidth-t.clientWidth;return Tt.body.removeChild(t),e}();t&&yt("html").css({"padding-right":t})}this.build(),this._triggerHook("beforeOpen",this.$el),yt(this.options.appendTo).eq(0).append(this.$photoviewer),this.addEvents(),this.setModalPos(this.$photoviewer),this._triggerHook("opened",this.$el)},e.close=function(){this._triggerHook("beforeClose",this.$el),this.$photoviewer.remove(),this.isOpened=!1,this.isMaximized=!1,this.isRotated=!1,this.rotateAngle=0;var t=!yt(Ot+"-modal").length;t&&this.options.fixedContent&&yt("html").css({overflow:"","padding-right":""}),t&&this.options.multiInstances&&(Pt.zIndex=this.options.zIndex),yt(Ot+"-modal").length||(Dt.off(It+Ft),Ht.off("resize"+Ft)),this._triggerHook("closed",this.$el)},e.setModalPos=function(t){var e=Ht.width(),i=Ht.height(),o=Dt.scrollLeft(),n=Dt.scrollTop(),s=this.options.modalWidth,a=this.options.modalHeight;this.options.initMaximized?(t.addClass(kt+"-maximize"),t.css({width:"100%",height:"100%",left:0,top:0}),this.isOpened=!0,this.isMaximized=!0):t.css({width:s,height:a,left:(e-s)/2+o+"px",top:(i-a)/2+n+"px"})},e.setModalSize=function(t){var e=this,i=Ht.width(),o=Ht.height(),n=Dt.scrollLeft(),s=Dt.scrollTop(),a={left:this.$stage.css("left"),right:this.$stage.css("right"),top:this.$stage.css("top"),bottom:this.$stage.css("bottom"),borderLeft:this.$stage.css("border-left-width"),borderRight:this.$stage.css("border-right-width"),borderTop:this.$stage.css("border-top-width"),borderBottom:this.$stage.css("border-bottom-width")},r=t.width+parseFloat(a.left)+parseFloat(a.right)+parseFloat(a.borderLeft)+parseFloat(a.borderRight),h=t.height+parseFloat(a.top)+parseFloat(a.bottom)+parseFloat(a.borderTop)+parseFloat(a.borderBottom),l=(0<this.options.gapThreshold?this.options.gapThreshold:0)+1,c=Math.min(i/(r*l),o/(h*l),1),u=Math.max(r*c,this.options.modalWidth),f=Math.max(h*c,this.options.modalHeight),d={width:(u=this.options.fixedModalSize?this.options.modalWidth:Math.round(u))+"px",height:(f=this.options.fixedModalSize?this.options.modalHeight:Math.round(f))+"px",left:(i-u)/2+n+"px",top:(o-f)/2+s+"px"};this.options.initAnimation?this.$photoviewer.animate(d,400,"ease-in-out",function(){e.setImageSize(t)}):(this.$photoviewer.css(d),this.setImageSize(t)),this.isOpened=!0},e.getImageScaleToStage=function(t,e){return this.isRotated?Math.min(t/this.img.height,e/this.img.width,1):Math.min(t/this.img.width,e/this.img.height,1)},e.setImageSize=function(t){var e={w:this.$stage.width(),h:this.$stage.height()},i=this.getImageScaleToStage(e.w,e.h);this.$image.css({width:Math.ceil(t.width*i)+"px",height:Math.ceil(t.height*i)+"px",left:(e.w-Math.ceil(t.width*i))/2+"px",top:(e.h-Math.ceil(t.height*i))/2+"px"}),yt.extend(this.imageData,{initWidth:t.width*i,initHeight:t.height*i,initLeft:(e.w-t.width*i)/2,initTop:(e.h-t.height*i)/2,width:t.width*i,height:t.height*i,left:(e.w-t.width*i)/2,top:(e.h-t.height*i)/2}),Ct({w:this.$image.width(),h:this.$image.height()},{w:this.$stage.width(),h:this.$stage.height()},this.$stage,this.isRotated),this.imgLoaded||(this.$photoviewer.find(Ot+"-loader").remove(),this.$stage.removeClass("stage-ready"),this.$image.removeClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.fadeIn(),this.imgLoaded=!0)},e.loadImg=function(t,e,i){var o=this;this.$image.removeAttr("style").attr("src",""),this.isRotated=!1,this.rotateAngle=0,this.imgLoaded=!1,this.$photoviewer.append('<div class="'+kt+'-loader"></div>'),this.$stage.addClass("stage-ready"),this.$image.addClass("image-ready"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.hide(),this.$image.attr("src",t),function(t,e,i){var o=new Image;o.onload=function(){e(o)},o.onerror=function(){i(o)},o.src=t}(t,function(t){o.img=t,o.imageData={originalWidth:t.width,originalHeight:t.height},o.isMaximized||o.isOpened&&o.options.fixedModalPos?o.setImageSize(t):o.setModalSize(t),e&&e.call()},function(){o.$photoviewer.find(Ot+"-loader").remove(),i&&i.call()}),this.options.title&&this.setImgTitle(t)},e.setImgTitle=function(t){var e=this.groupData[this.groupIndex].title||function(t){return t.replace(/^.*?\/*([^/?]*)\.[a-z]+(\?.+|$)/gi,"$1")}(t);this.$title.html(e)},e.jump=function(t){this._triggerHook("beforeChange",this.groupIndex),this.groupIndex=this.groupIndex+t,this.jumpTo(this.groupIndex)},e.jumpTo=function(t){var e=this;0<=(t%=this.groupData.length)?t%=this.groupData.length:t<0&&(t=(this.groupData.length+t)%this.groupData.length),this.groupIndex=t,this.loadImg(this.groupData[t].src,function(){e._triggerHook("changed",t)},function(){e._triggerHook("changed",t)})},e.wheel=function(t){t.preventDefault();var e=1;t.deltaY?e=0<t.deltaY?1:-1:t.wheelDelta?e=-t.wheelDelta/120:t.detail&&(e=0<t.detail?1:-1);var i=-e*this.options.ratioThreshold,o={x:t.clientX-this.$stage.offset().left+Dt.scrollLeft(),y:t.clientY-this.$stage.offset().top+Dt.scrollTop()};this.zoom(i,o,t)},e.zoom=function(t,e,i){t=t<0?1/(1-t):1+t,(t=this.$image.width()/this.imageData.originalWidth*t)>this.options.maxRatio||t<this.options.minRatio||this.zoomTo(t,e,i)},e.zoomTo=function(t,e,i){var o=this.$image,n=this.$stage,s=this.imageData.width,a=this.imageData.height,r=this.imageData.left,h=this.imageData.top,l={w:n.width(),h:n.height(),x:n.offset().left,y:n.offset().top},c=this.imageData.originalWidth*t,u=this.imageData.originalHeight*t,f=e.x-(e.x-r)/s*c,d=e.y-(e.y-h)/a*u,p=this.isRotated?(c-u)/2:0,g=this.isRotated?u:c,m=this.isRotated?c:u,v=l.w-c,w=l.h-u;d=m<=l.h?(l.h-u)/2:p<d?p:w-p<d?d:w-p,f=g<=l.w?(l.w-c)/2:-p<f?-p:v+p<f?f:v+p,Math.abs(this.imageData.initWidth-c)<.05*this.imageData.initWidth?this.setImageSize(this.img):(o.css({width:Math.round(c)+"px",height:Math.round(u)+"px",left:Math.round(f)+"px",top:Math.round(d)+"px"}),Ct({w:Math.round(g),h:Math.round(m)},{w:l.w,h:l.h},this.$stage)),yt.extend(this.imageData,{width:c,height:u,left:f,top:d})},e.rotate=function(t){this.rotateAngle=this.rotateAngle+t,this.rotateAngle/90%2==0?this.isRotated=!1:this.isRotated=!0,this.rotateTo(this.rotateAngle)},e.rotateTo=function(t){this.$image.css({transform:"rotate("+t+"deg)"}),this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight}),this.$stage.removeClass("is-grab")},e.resize=function(){var t=this;return function(i,o){var n=null;return function(){var t=this,e=arguments;clearTimeout(n),n=setTimeout(function(){i.apply(t,e)},o)}}(function(){t.isOpened&&(t.isMaximized?t.setImageSize({width:t.imageData.originalWidth,height:t.imageData.originalHeight}):t.setModalSize({width:t.imageData.originalWidth,height:t.imageData.originalHeight}))},500)},e.maximize=function(){if(this.isMaximized){this.$photoviewer.removeClass(kt+"-maximize");var t=(Ht.width()-this.options.modalWidth)/2+Dt.scrollLeft(),e=(Ht.height()-this.options.modalHeight)/2+Dt.scrollTop();this.$photoviewer.css({width:this.modalData.width?this.modalData.width:this.options.modalWidth,height:this.modalData.height?this.modalData.height:this.options.modalHeight,left:this.modalData.left?this.modalData.left:t,top:this.modalData.top?this.modalData.top:e}),this.isMaximized=!1}else this.modalData={width:this.$photoviewer.width(),height:this.$photoviewer.height(),left:this.$photoviewer.offset().left,top:this.$photoviewer.offset().top},this.$photoviewer.addClass(kt+"-maximize"),this.$photoviewer.css({width:"100%",height:"100%",left:0,top:0}),this.isMaximized=!0;this.setImageSize({width:this.imageData.originalWidth,height:this.imageData.originalHeight})},e.fullscreen=function(){!function(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}(this.$photoviewer[0])},e.keydown=function(t){if(!this.options.keyboard)return!1;var e=t.keyCode||t.which||t.charCode,i=t.ctrlKey||t.metaKey,o=t.altKey||t.metaKey;switch(e){case 37:this.jump(-1);break;case 39:this.jump(1);break;case 187:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 189:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 61:this.zoom(3*this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 173:this.zoom(3*-this.options.ratioThreshold,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 48:i&&o&&this.zoomTo(1,{x:this.$stage.width()/2,y:this.$stage.height()/2},t);break;case 188:i&&this.rotate(-90);break;case 190:i&&this.rotate(90);break;case 81:this.close()}},e.addEvents=function(){var e=this;this.$close.off(Vt+Ft).on(Vt+Ft,function(t){e.close()}),this.$stage.off(Et+Ft).on(Et+Ft,function(t){e.wheel(t)}),this.$zoomIn.off(Vt+Ft).on(Vt+Ft,function(t){e.zoom(3*e.options.ratioThreshold,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$zoomOut.off(Vt+Ft).on(Vt+Ft,function(t){e.zoom(3*-e.options.ratioThreshold,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$actualSize.off(Vt+Ft).on(Vt+Ft,function(t){e.zoomTo(1,{x:e.$stage.width()/2,y:e.$stage.height()/2},t)}),this.$prev.off(Vt+Ft).on(Vt+Ft,function(){e.jump(-1)}),this.$fullscreen.off(Vt+Ft).on(Vt+Ft,function(){e.fullscreen()}),this.$next.off(Vt+Ft).on(Vt+Ft,function(){e.jump(1)}),this.$rotateLeft.off(Vt+Ft).on(Vt+Ft,function(){e.rotate(-90)}),this.$rotateRight.off(Vt+Ft).on(Vt+Ft,function(){e.rotate(90)}),this.$maximize.off(Vt+Ft).on(Vt+Ft,function(){e.maximize()}),Dt.off(It+Ft).on(It+Ft,function(t){e.keydown(t)}),Ht.on("resize"+Ft,this.resize())},e._triggerHook=function(t,e){this.options.callbacks[t]&&this.options.callbacks[t].apply(this,yt.isArray(e)?e:[e])},t}();return yt.extend(Wt.prototype,jt,Bt,Yt),window.PhotoViewer=Wt});